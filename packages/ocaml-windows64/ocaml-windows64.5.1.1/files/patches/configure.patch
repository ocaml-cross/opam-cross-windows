--- ocaml-5.1.1/configure.orig	2024-02-25 18:21:29.787786010 +0000
+++ ocaml-5.1.1/configure	2024-02-25 18:21:31.795786011 +0000
@@ -13947,6 +13947,14 @@



+  flexlink_where_cmd_prefix=''
+  case $build in #(
+  *-w64-mingw32*|*-pc-windows) :
+    flexlink_where_cmd_prefix="cmd /c" ;; #(
+  *) :
+     ;;
+esac
+
   if test -n "$flexlink" && test -z "$flexdir"
 then :

@@ -14024,7 +14032,7 @@

     case $host in #(
   *-w64-mingw32*|*-pc-windows) :
-    flexlink_where="$(cmd /c "$flexlink" -where 2>/dev/null)"
+    flexlink_where="$($flexlink_where_cmd_prefix "$flexlink" -where 2>/dev/null)"
       if test -z "$flexlink_where"
 then :
   as_fn_error $? "$flexlink is not executable from a native Win32 process" "$LINENO" 5
@@ -18358,9 +18366,17 @@

 ## Determine how to link with the POSIX threads library

+extra_mingw_pthread_lib=''
+case $build in #(
+  *-*-mingw32*) :
+    extra_mingw_pthread_lib="-lgcc_eh" ;; #(
+  *) :
+     ;;
+esac
+
 case $host in #(
   *-*-mingw32*) :
-    PTHREAD_LIBS="-l:libpthread.a -lgcc_eh" ;; #(
+    PTHREAD_LIBS="-l:libpthread.a $extra_mingw_pthread_lib" ;; #(
   *-pc-windows) :
     PTHREAD_LIBS="-l:libpthread.lib" ;; #(
   *) :
